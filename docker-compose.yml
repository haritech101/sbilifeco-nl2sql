services:
    metadata-storage:
        image: sbilife/metadata-storage:202506.13.0628
        volumes:
            - /var/lib/sbilifeco/db-metadata:/var/lib/sbilifeco/db-metadata
        ports:
            - 11202:80
        labels:
            - traefik.http.routers.metadata-storage.rule=PathPrefix(`/api/v1/db-metadata`)
            - traefik.http.services.metadata-storage.loadbalancer.server.url=http://metadata-storage
    llm:
        image: sbilife/llm:202506.13.0631
        environment:
            - LLM_MODEL=gemini-1.5-flash
            - API_KEY=AIzaSyANExa3L6OVR0RevN8zteCuA8agcPFl3EU
        ports:
            - 11203:80
        labels:
            - traefik.http.routers.llm.rule=PathPrefix(`/api/v1/llm`)
            - traefik.http.services.llm.loadbalancer.server.url=http://llm
    query-flow:
        image: sbilife/query-flow:202506.17.1437
        environment:
            - LLM_HOST=llm
            - METADATA_STORAGE_HOST=metadata-storage
        ports:
            - 11204:80
        labels:
            - traefik.http.routers.query-flow.rule=PathPrefix(`/api/v1/query-flow`)
            - traefik.http.services.query-flow.loadbalancer.server.url=http://query-flow
    traefik:
        image: traefik:v3.4
        volumes:
            - /var/run/docker.sock:/var/run/docker.sock
        command:
            - --api.insecure=true
            - --providers.docker=true
        ports:
            - 11200:80
            - 11201:8080
