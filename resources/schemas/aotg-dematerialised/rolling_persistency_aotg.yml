cubes:
    - name: rolling_persistency_aotg
      description:
          Rolling persistency data tracking current year collectable and collected premium amounts across business dimensions and time periods.
          This table is self-contained and does not need to be joined with other tables for information.
      sql_table: rolling_persistency_aotg

      dimensions:
          - name: branch
            type: string
            sql: branch
            description:
                Business branch or office location for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: broad_segment
            type: string
            sql: broad_segment
            description:
                High-level product categorization or business segment for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: channel
            type: string
            sql: channel
            description:
                Distribution channel through which policies were sold for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: lob
            type: string
            sql: lob
            description:
                Line of Business for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: product
            type: string
            sql: product
            description:
                Specific product name or code for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: region
            type: string
            sql: region
            description:
                Geographical region for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: zone
            type: string
            sql: zone
            description:
                Larger geographical zone for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

          - name: month
            type: string
            sql: month
            description: Reporting month in MMM-YY format (e.g., 'DEC-99', 'OCT-25') for which this record shows collectable and collected amounts.

          - name: period
            type: string
            sql: period
            description:
                Persistency measurement period (e.g., 13M, 25M, 37M) for which this record shows collectable and collected amounts.
                Before matching against this field in an analysis query, another query should extract the list of distinct values in this field across the table.
                The extracted list forms the list of all possible values and hence validates the analysis query.

      measures:
          - name: cy_collectable
            type: sum
            sql: cy_collectable
            description: Current year collectable premium amount aggregated across the dimensions.

          - name: cy_collected
            type: sum
            sql: cy_collected
            description: Current year collected premium amount aggregated across the dimensions. The percentage ratio of collected by collectable is persistency.
